---
layout: post
title: 操作系统——存储器管理
date: 2018-06-24
categories: blog
tags: 操作系统
description: 学习笔记。
---

## 前言

`操作系统原理`是武汉大学计算机学院软件工程专业大二下半学期所学习的一门专业课，教材为西安电子科技大学出版社的`计算机操作系统`第4版，这个专题的博客为该课程的学习笔记，该博客的主要内容是**存储器管理**
---
## 存储器的层次结构

![example](https://raw.githubusercontent.com/yaowenqing/blog.io/master/img/OS_26.png)

寄存器和主存储器被称为可执行存储器.进程可以在很少的时钟周期内使用一条load或store指令对可执行存储器进行访问，但对辅存的访问则需要通过I/O设备实现。

### 主存储器与寄存器

主存储器（主存、内存）
  - 保存进程运行时的程序和数据
寄存器
  - 访问速度最快、容量小、价格昂贵
  - 位于CPU内，暂存指令、地址、数据等
  
### 高速缓存和磁盘缓存
高速缓存
  - 容量大于寄存器，速度快于主存
  - 主要用于备份主存中较常用的数据，以减少处理机对主存储器的访问次数
  - 利用程序执行的局部性原理，经主存中经常要用到的信息存放在高速缓存中，减少访问主存的次数。
磁盘缓存
  - 为了缓和磁盘的I/O速度远低于对主存的访问速度这一不匹配的关系而设置。
  - 将频繁使用的磁盘数据暂时存放在磁盘缓存中，可以减少访问磁盘的次数

---
## 程序的装入和链接
用户程序转变为一个可以执行的程序经过以下几个步骤：编译、链接、装入

![example](https://raw.githubusercontent.com/yaowenqing/blog.io/master/img/OS_27.png)

### 程序的装入

为了阐述方便，先介绍一个无需进行链接的单个目标模块的装入过程，在将一个单个装入模块装入内存时可以有如下三种装入方式：

1. 绝对装入方式(Absolute Loading Mode) 

目标模块采用绝对地址。即逻辑地址和实际内存地址完全相同，装入时不需对地址进行变换。

特点：适用于单道环境。

2. 可重定位装入方式(Relocation Loading Mode)

多道环境下，目标模块的起始地址通常从0开始。根据内存的当前情况，将目标模块装入到内存适当位置。采用静态地址变换。

静态地址变换：又称静态地址重定位，地址变换在程序装入时一次完成，以后不再改变。

特点：不需硬件支持，但程序运行时不能在内存移动，程序需要连续存储空间，难以共享。

3. 动态运行时装入方式(Dynamic Run-time Loading)

动态运行时的装入程序，在把装入模块装入内存后，并不立即把装入模块中的相对地址转换为绝对地址，而是把这种地址转换推迟到程序真正要执行时才进行。因此， 装入内存后的所有地址都仍是相对地址。 

特点：需要重定位寄存器支持。程序可以在内存中移动，可以实现虚拟存储。.

### 程序的链接

源程序编译后得到一组目标模块，链接程序的功能是将这组目标模块以及它们所需要的库函数装配成一个完整的装入模块。在对目标模块进行链接时，根据进行链接的时间不同，可把链接分成如下三种：

1. 静态链接

程序运行前，先将各目标模块以及它们所需的库函数，链接成一个完整的装入模块，不再拆开。

2. 装入时动态链接

在装入时采用边装入边链接的方式装入。

优点：便于修改和更新；便于实现目标模块共享

3. 运行时动态链接

对模块的链接推迟到程序执行时才去进行链接。

优点：加快装入过程；节省内存空间

---
## 连续分配存储管理方式

连续分配方式，是指为一个用户程序分配一个连续的内存空间。包括：

单一连续分配、固定分区分配、动态分区分配、动态重定位分配

- 单一连续分配
  - 把内存分为系统区和用户区两部分，系统区仅提供给OS使用，通常是放在内存的低址部分；用户区是指除系统区以外的全部内存空间， 提供给用户使用。 
  - 特点：最简单；适用于单用户、单任务的OS
- 固定分区分配
  - 固定分区分配是多道程序系统中采用的一种最简单的存储管理方法。预先将内存空间划分为若干个固定大小的分区，每个分区中可以装入一道程序。分区的位置及大小在运行期间不能改变。
      各分区的大小可以相等，也可以不相等。
  - 两个固定：
    - 各分区的大小固定不变
    - 总分区的个数固定不变
    
    
